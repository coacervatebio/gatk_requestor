apiVersion: apps/v1

kind: Deployment

metadata:
  name: coacervate-deployment

  labels:
    app: coacervate

spec:
  replicas: 1

  selector:
    matchLabels:
      app: coacervate

  template:
    metadata:
      labels:
        app: coacervate

    spec:
      volumes:
        - name: coacervate-pv-storage
          persistentVolumeClaim:
            claimName: coacervate-pvc
        - name: yagna-socket
          emptyDir: {}
      containers:
        - name: yagna
          image: yagna:latest
          imagePullPolicy: Never
          volumeMounts:
            - name: coacervate-pv-storage
              mountPath: /root/.local/share/
            - name: yagna-socket
              mountPath: /tmp
        - name: testo
          image: yagna:latest
          imagePullPolicy: Never
          command: ["sleep", "3600"]
          volumeMounts:
            - name: coacervate-pv-storage
              mountPath: /coacervate
            - name: yagna-socket
              mountPath: /tmp
